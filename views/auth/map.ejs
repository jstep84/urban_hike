<% include ../partials/header.ejs %>

<a href="/auth/logout" class="btn btn-primary">Logout</a>
<p>map page works!</p>
<div id='map'></div>	
<div id='cw'></div>

<script src="http://www.google.com/jsapi?key=<%= gmapsApi %>"></script>
<script>
	(function () {
		google.load("maps", "2");
		google.setOnLoadCallback(function () {
			// Create map
			var map = new google.maps.Map2(document.getElementById("map")),
				markOutLocation = function (lat, long) {
					var latLong = new google.maps.LatLng(lat, long),
					marker = new google.maps.Marker(latLong);
					map.setCenter(latLong, 15);
					map.addOverlay(marker);
					console.log(latLong);
				};
				map.setUIToDefault();

			// Check for geolocation support	
			if (navigator.geolocation) {
				// Get current position
				navigator.geolocation.getCurrentPosition(function (position) {
						// Success!
						markOutLocation(position.coords.latitude, position.coords.longitude);
						console.log(position.coords.latitude, position.coords.longitude);
						if (position.coords.latitude >= 47.647 && position.coords.longitude <= -122.335) {
							//do this;
							console.log('user is in the North-West sector');
						} else if (position.coords.latitude >= 47.647 && position.coords.longitude > -122.335) {
							//do this;
							console.log('user is in the North-East sector');
						} else if (position.coords.latitude < 47.647 && position.coords.latitude >= 47.601 && position.coords.longitude <= -122.320) {
							//do this;
							console.log('user is in the Central-West sector');
							document.getElementById("cw");
						} else if (position.coords.latitude < 47.647 && position.coords.latitude >= 47.601 && position.coords.longitude > -122.320) {
							//do this;
							console.log('user is in the Central-East sector');
						} else if (position.coords.latitude < 47.601 && position.coords.longitude <= -122.343) {
							//do this;
							console.log('user is in the South-West sector');
						} else {
							//do this;
							console.log('user is in the South-East sector');
						}
					}, 
					function () {
						markOutLocation(59.3325215, 18.0643818);
					}
				);
			}
			else {
				markOutLocation(-27.121192, -109.366424);
			}
		});	
	})();

</script>

<% include ../partials/footer.ejs %>

